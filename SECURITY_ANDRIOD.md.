# ğŸ”’ Security Notes â€” Android (Linguamate AI)

This document defines the **security posture** of the Linguamate AI Android app.  
It addresses client-side protections, backend hardening, secrets management, compliance with Google Play policies, and planned enhancements.  
All practices align with OWASP MASVS, Google Play requirements, and modern Android security guidance.  

---

## ğŸŒ Transport Security (Network Layer)
- âœ… All traffic is transmitted exclusively over **HTTPS/TLS 1.2+**.  
- âœ… Cleartext HTTP blocked in `AndroidManifest.xml` via `android:usesCleartextTraffic="false"`.  
- âœ… Backend (Hono) enforces strong cipher suites (TLS 1.2/1.3 only).  
- âœ… Certificate pinning **planned** for high-sensitivity endpoints (e.g., authentication).  
- âœ… HSTS enabled at server layer: `Strict-Transport-Security: max-age=31536000; includeSubDomains; preload`.  
- âœ… No mixed content allowed (all assets served via HTTPS).  

---

## ğŸ”‘ Secrets Management
- âŒ No hardcoded API keys, secrets, or credentials in the client.  
- âœ… Only **public, non-sensitive configs** exposed via `EXPO_PUBLIC_*` environment variables.  
- âœ… Sensitive values (API keys, signing tokens) remain **server-side only** or inside CI/CD secret managers.  
- âœ… Server responds with temporary tokens scoped to least privilege.  
- âœ… GitHub repo monitored with **Gitleaks** and **secret scanning** to prevent accidental key commits.  

---

## ğŸ›¡ Backend Hardening (tRPC + Hono)
- âœ… Rate limiting, abuse detection, and throttling enforced at API gateway.  
- âœ… Structured error messages â€” no raw stack traces exposed.  
- âœ… CORS policy:
  - **Development:** open for localhost + staging.  
  - **Production:** locked to `linguamate.ai` and `app.linguamate.ai`.  
- âœ… Security headers:
  - `Content-Security-Policy` (restrict script/img origins).  
  - `X-Frame-Options: DENY`.  
  - `X-Content-Type-Options: nosniff`.  
  - `Referrer-Policy: strict-origin-when-cross-origin`.  
  - `Permissions-Policy: microphone=(), camera=(), geolocation=()`.  
- âœ… Backend health checks on `/api/health` exclude sensitive details.  

---

## ğŸ¤– Content Moderation (AI Safety)
- âœ… AI prompt/response moderation handled **server-side** (before reaching clients).  
- âœ… Filters applied for:
  - Profanity, hate speech, harassment.  
  - Illegal or harmful content.  
  - Sensitive personally identifiable information.  
- âœ… Moderation events logged as metadata only (no raw prompts stored).  
- âœ… User-facing AI always returns **safe fallback messages** if filtered.  

---

## ğŸ¤ Permissions Model (Least Privilege)
- âœ… **Microphone**: requested *only* when user taps â€œrecordâ€ for speech-to-text.  
- âŒ No background or persistent microphone recording.  
- âœ… No access requested for:
  - Location.  
  - Contacts.  
  - SMS.  
  - External storage (beyond app sandbox).  
- âœ… Clear rationale provided before runtime permission request:
  > â€œLinguamate uses your microphone only while youâ€™re speaking to practise pronunciation. Audio is never stored without your consent.â€  

---

## ğŸ“Š Logging & Observability
- âœ… Logs exclude PII, authentication tokens, or sensitive user content.  
- âœ… All API logs use **correlation IDs** to trace flows across client/server.  
- âœ… Sensitive values (JWTs, API keys) **redacted** before logging.  
- âœ… Client logs disabled in production builds (only structured errors reported).  
- âœ… Crash/analytics logs opt-in with **user controls** in Settings â†’ Privacy.  

---

## ğŸ” Secure Storage
- âœ… **On native builds**: tokens stored in `expo-secure-store` (encrypted at rest).  
- âœ… **On web fallback**: HttpOnly cookies preferred; localStorage only with CSRF/XSS protections.  
- âœ… Refresh tokens:
  - Short-lived.  
  - Revocable server-side.  
  - Rotated on use (to prevent replay).  
- âœ… Session expiry enforced after inactivity.  

---

## ğŸ“¦ Dependency & SDK Hygiene
- âœ… Regular updates of **Expo SDK**, **React Native**, and third-party libraries.  
- âœ… Automated monitoring:  
  - **Dependabot** for npm package updates.  
  - **npm audit** run in CI pipeline.  
  - **Semgrep** for static security scans.  
  - **Gitleaks** for secret detection.  
- âœ… Unused/abandoned packages actively removed to reduce attack surface.  
- âœ… All transitive dependencies reviewed at each major release.  

---

## ğŸ“± Play Store & Device Compliance
- âœ… Complies with **Google Play Data Safety**:  
  - Microphone optional, user-triggered.  
  - Storage scoped to app sandbox only.  
- âœ… Runtime permission rationale shown before microphone request.  
- âœ… Android App Integrity enabled via Play App Signing.  
- âœ… App tested against Google Play **Pre-Launch Reports** (stability, accessibility, security).  
- âœ… No use of restricted APIs (SMS, Call Logs, etc.).  

---

## ğŸ§­ Future Enhancements (Planned)
- ğŸ”œ **Play Integrity API**: device attestation to detect tampered/rooted devices.  
- ğŸ”œ **Server-side anomaly detection** for unusual API usage (e.g., token reuse, high-volume abuse).  
- ğŸ”œ **Penetration testing** reports stored under `docs/security/pentest/` before each major release.  
- ğŸ”œ **Continuous fuzz testing** of backend endpoints (tRPC router).  
- ğŸ”œ Expand CI/CD pipeline with **dynamic app security testing (DAST)**.  

---

âœ… With these measures, Linguamate AI maintains a **least-privilege, defense-in-depth** approach across Android and backend infrastructure.
